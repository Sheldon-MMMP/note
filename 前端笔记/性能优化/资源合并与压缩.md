# 资源合并与压缩

## HTML压缩
HTML代码压缩就是压缩这些在文本文件中有意义，但是在HTML中不显示的字符，包括空格，制表符，换行符等，这些有一些其他意义的字符，如HTML注释也可以被压缩。
![[Pasted image 20220616154720.png]]
- 红色的线是压缩了HTML的大小
- 蓝色的线是没有压缩的HTML大小
- 黄色的线是pzip压缩的大小

>我们发现HTML压缩的效果不是很明显，但是实际上：

![[Pasted image 20220616155058.png]]


### 如何进行HTML压缩：
1. 使用在线网站进行压缩
2. node.js提供了html-minifier工具
3. 后端模板引擎渲染压缩

## css压缩
- 无效代码删除（如注释、空格、回车）
- 语义合并

### 如何进行CSS压缩：
1. 使用在线网站进行压缩
2. 使用html-minifier对html中的css进行压缩
3. 使用clean-css对css进行压缩

## JS压缩与混乱
- 无效字符的删除
- 剔除注释
- 代码语义的缩减和优化（将变量名缩短）
- 代码保护

### 如何进行js压缩和混乱
1. 使用在线网站进行压缩
2. 使用html-minifier对html中的js进行压缩
3. 使用uglifyjs2对js进行压缩



## 文件合并
![[Pasted image 20220616161011.png]]

**如果不合并文件会发生的问题：**
- 文件与文件之间有插入的上行请求，增加了N-1个网络延迟
- 受丢包问题影响更严重
- 经过代理服务器时可能会被断开

**文件合并存在的问题：**
- 首屏渲染问题
	- 如果页面依赖于js文件渲染的话，那页面就要等待js发送完成再开始渲染，就比较慢，常出现在使用大型框架渲染时（react、vue等）
- 缓存失效问题


> 文件合并的几个建议：
>- 公共库合并
> - 不同页面的合并
> - 见机行事，随机应变

### 如何进行文件合并：
1. 使用在线网站进行文件合并
2. 使用nodejs实现文件合并